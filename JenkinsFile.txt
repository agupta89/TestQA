env.environment =""
properties([pipelineTriggers([githubPush()])])

pipeline {
agent any 

stages {
        stage('Detect DEV Changes') {
		when {
                   anyOf { 
		   branch 'master'; branch 'STG' ; branch 'Dev'
		   }
	           beforeAgent true
		   }
                   steps {
		   echo 'Hello World'
                   script {			    	
                   if ("${env.GIT_BRANCH}" == "master") {
                   env.environment = "Dev"
		    } else if("${env.GIT_BRANCH}" == "STG"){
                   env.environment = "STG"
		    } else {
                    env.environment = "master"
                   }
		    echo env.environment
		    checkout([$class: 'GitSCM', branches: [[name: ${env.environment}]],doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[url: 'https://github.com/agupta89/TestDev.git']]])
                    
                }
		  		
            }
}

    stage('Testing Code') {
           steps {     
           {
                echo 'Hello'
                git branch: 'master', url: 'git@github.com:agupta89/LeedOnlineAppTest.git'
                echo 'Test Started'
                echo env.environment
		
            }
        }
    }

      stage('Publish Html Report') {
            steps {
                echo 'Extend Report'       
        }

        }   
}
}